function ready(t,e){function a(t){c.datum(topojson.mesh(e,e.objects.counties,function(e,a){return e.id===t.id||a.id===t.id})).attr("d",path).style("visibility","visible")}function o(){c.style("visibility","hidden")}function n(t){null===centered&&(a(t),i(t,["democrat","republican"]))}function r(){null===centered&&(o(),d())}function i(t,a){var o=path.bounds(t),n=d3.scale.linear().domain([0,width]).range([0,parseFloat(svg.style("width"))]),r=n((o[0][0]+o[1][0])/2),i=n(o[0][1]);p.html(""),p.append("b").classed("tooltip-title",!0).text(t.properties.name);var a=p.selectAll(".tooltip-row").data(a).enter().append("div").classed("tooltip-row",!0);a.append("span").classed("tooltip-color",!0).style("background-color",function(t){return e.election[t].color}),a.append("span").classed("tooltip-name",!0).text(function(t){return e.election[t].candidate}),a.append("span").classed("tooltip-number",!0).text(function(e){return numberString(t.properties[e])}),a.append("span").classed("tooltip-percent",!0).text(function(e){return percentString(t.properties[e]/t.properties.total)}),tooltipWidth=parseFloat(p.style("width"))+parseFloat(p.style("padding-left"))+parseFloat(p.style("padding-right"))+parseFloat(p.style("border-left-width"))+parseFloat(p.style("border-right-width")),p.style("left",r-tooltipWidth/2+"px").style("top",i/16-6.2+"em").style("visibility","visible")}function d(){p.style("visibility","hidden")}function l(t){var e,n,r;if(t&&centered!==t){var i=path.centroid(t);e=i[0],n=i[1],r=4,centered=t,a(t)}else e=width/2,n=height/2,r=1,centered=null,o();s.transition().duration(750).attr("transform","translate("+width/2+","+height/2+")scale("+r+")translate("+-e+","+-n+")").style("stroke-width",1/Math.sqrt(r)+"px"),d()}svg.append("rect").attr("class","background").attr("width",width).attr("height",height).on("click",l);var s=svg.append("g").attr("id","state");s.append("g").attr("id","counties").selectAll(".county").data(topojson.feature(e,e.objects.counties).features).enter().append("path").classed("county",!0).attr("d",path).style("fill",function(t){var e=t.properties;return republicanOrDemocrat((e.republican-e.democrat)/e.total)(e.weight)}).on("mouseover",n).on("mouseout",r).on("click",l),s.append("path").datum(topojson.mesh(e,e.objects.counties,function(t,e){return t.id!==e.id})).attr("id","county-borders").attr("d",path);var c=s.append("path").attr("id","county-border"),p=root.append("div").attr("id","tooltip").style("position","absolute").style("visibility","hidden")}function percentString(t,e){"undefined"==typeof e&&(e=1);var a=Math.round(1e3*t)/10;return a.toFixed(e)+"%"}function numberString(t){return(""+t).replace(/(\d)(?=(?:\d{3})+$)/g,"$1,")}var width=960,height=500,centered=null,root=d3.select("body").append("div").attr("id","graphic"),svg=root.append("svg").attr("viewBox","0 0 "+width+" "+height),colorDomain=[.035,.15],redScale=d3.scale.threshold().domain(colorDomain).range(["#fee0d2","#fc9272","#de2d26"]),blueScale=d3.scale.threshold().domain(colorDomain).range(["#deebf7","#9ecae1","#3182bd"]),purpleScale=d3.scale.threshold().domain(colorDomain).range(["#efedf5","#bcbddc","#756bb1"]),republicanOrDemocrat=d3.scale.threshold().domain([-.05,.05]).range([blueScale,purpleScale,redScale]),projection=d3.geo.albers().center([0,38.85]).rotate([77.25,0]).parallels([37,40]).scale(1e4).translate([width/2,height/2]),path=d3.geo.path().projection(projection);queue().defer(d3.json,"static/json/maryland.json").await(ready);